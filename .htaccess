<IfModule mod_rewrite.c>
    RewriteEngine On
    
    RewriteCond %{HTTP_USER_AGENT} "Mozilla" [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} "Chrome" [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} "Firefox" [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} "Safari" [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} "Edge" [NC,OR]
    RewriteRule ^ - [L]
    RewriteRule ^ - [F,L]

    RewriteCond %{HTTP:Authorization} . 
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_URI} (.+)/$ [NC]
    RewriteRule ^ %1 [L,R=301]

    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^ index.php [L]

    RewriteCond %{QUERY_STRING} author=\d+ [NC]
    RewriteRule .* - [F]

    RewriteCond %{HTTPS} !=on
    RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
</IfModule>

<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access plus 1 week"
</IfModule>

Options -Indexes
ServerSignature Off

<IfModule mod_security.c>
    SecRuleEngine On
    SecRequestBodyAccess On
    SecResponseBodyAccess Off
    SecAuditEngine RelevantOnly
    SecAuditLogParts ABIFHZ
    SecAuditLogType Serial
    SecRuleRemoveById 950100
</IfModule>

<IfModule mod_evasive.c>
    DOSHashTableSize 3097
    DOSPageCount 5
    DOSSiteCount 50
    DOSPageInterval 1.0
    DOSSiteInterval 1.0
    DOSBlockingPeriod 20
</IfModule>

LimitRequestBody 2097152